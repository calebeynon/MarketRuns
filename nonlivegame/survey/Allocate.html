{{ block title }}Part 2{{ endblock }}
{{ block content }}

<style>
    body {
        background-color: #f0f0f0; /* Light Gray */
        color: #333; /* Dark Gray */
    }

    .container {
        max-width: 900px;
        margin: 0 auto;
        background: white;
        border-radius: 8px;
        box-shadow: 0 15px 35px rgba(0,0,0,0.1);
        overflow: hidden;
        animation: fadeIn 0.8s ease-out;
    }

    @keyframes fadeIn {
        from { opacity: 0; transform: translateY(20px); }
        to { opacity: 1; transform: translateY(0); }
    }

    .header {
        background: #555;
        color: white;
        padding: 30px;
        text-align: center;
        box-shadow: 0 4px 6px rgba(0,0,0,0.1);
    }

    .header h1 {
        margin: 0;
        font-size: 2.5em;
        font-weight: 300;
        text-shadow: 2px 2px 4px rgba(0,0,0,0.3);
    }

    .header p {
        margin: 10px 0 0;
        font-size: 1.1em;
        opacity: 0.9;
    }

    .survey-section {
        padding: 30px;
        background: white;
    }

    .form-group {
        margin-bottom: 25px;
        padding: 20px;
        background: #f8f9fa;
        border-radius: 6px;
        border-left: 5px solid #555;
        box-shadow: 0 3px 10px rgba(0,0,0,0.05);
    }

    .form-group .form-label {
        font-weight: bold;
        color: #333;
        font-size: 1.1em;
        margin-bottom: 15px;
        display: block;
    }

    .form-group .form-control {
        width: 100%;
        padding: 12px 15px;
        border: 2px solid #e0e0e0;
        border-radius: 6px;
        font-size: 1em;
        font-family: inherit;
        transition: border-color 0.3s ease;
    }

    .form-group .form-control:focus {
        outline: none;
        border-color: #555;
    }

    .form-group .form-check-label {
        display: flex;
        align-items: center;
        padding: 10px 15px;
        background: white;
        border: 2px solid #e0e0e0;
        border-radius: 6px;
        cursor: pointer;
        transition: all 0.3s ease;
        font-size: 1em;
    }

    .form-group .form-check-label:hover {
        background: #f5f5f5;
        border-color: #555;
    }

    .form-group .form-check-input {
        margin-right: 10px;
    }

    .question-section {
        margin-bottom: 40px;
        padding: 20px;
        background: #f8f9fa;
        border-radius: 8px;
        border-left: 5px solid #555;
    }

    .question-section h3 {
        color: #555;
        margin-bottom: 15px;
        font-size: 1.3em;
        font-weight: 600;
    }

    .question-section p {
        color: #666;
        margin-bottom: 20px;
        font-style: italic;
    }

    .action-section {
        padding: 30px;
        background: #f8f9fa;
        text-align: center;
        border-top: 1px solid #e0e0e0;
    }

    .submit-button {
        background: #555;
        color: white;
        border: none;
        padding: 15px 40px;
        font-size: 1.2em;
        font-weight: 600;
        border-radius: 6px;
        cursor: pointer;
        transition: all 0.3s ease;
        box-shadow: 0 8px 20px rgba(85, 85, 85, 0.3);
        text-transform: uppercase;
        letter-spacing: 1px;
    }

    .submit-button:hover {
        transform: translateY(-3px);
        box-shadow: 0 12px 25px rgba(85, 85, 85, 0.4);
    }

    .section-container {
        display: none;
        opacity: 0;
        transition: opacity 0.5s ease-in-out;
    }
    
    .section-container.active {
        display: block;
        opacity: 1;
    }
    
    .continue-button {
        background: #555;
        color: white;
        border: none;
        padding: 12px 30px;
        font-size: 1.1em;
        font-weight: 600;
        border-radius: 6px;
        cursor: pointer;
        transition: all 0.3s ease;
        box-shadow: 0 6px 15px rgba(85, 85, 85, 0.3);
        text-transform: uppercase;
        letter-spacing: 1px;
        margin: 20px 0;
        display: none;
    }
    
    .continue-button:hover {
        transform: translateY(-2px);
        box-shadow: 0 8px 20px rgba(85, 85, 85, 0.4);
    }
    
    .continue-button.visible {
        display: inline-block;
    }
    
    .section-progress {
        text-align: center;
        padding: 20px;
        background: #f8f9fa;
        border-bottom: 1px solid #e0e0e0;
    }
    
    .progress-indicator {
        font-size: 1.1em;
        color: #555;
        font-weight: 600;
    }
    
    /* Slider Styling */
    .slider-container {
        padding: 20px;
        text-align: center;
    }
    
    .slider-wrapper {
        display: flex;
        align-items: center;
        justify-content: center;
        gap: 20px;
        margin: 20px 0;
    }
    
    .slider-label {
        font-weight: bold;
        color: #555;
        font-size: 1.1em;
        min-width: 30px;
    }
    
    .allocation-slider {
        flex: 1;
        max-width: 400px;
        height: 8px;
        background: #e0e0e0;
        border-radius: 5px;
        outline: none;
        -webkit-appearance: none;
        transition: background 0.3s ease;
    }
    
    .allocation-slider::-webkit-slider-thumb {
        -webkit-appearance: none;
        appearance: none;
        width: 24px;
        height: 24px;
        background: #555;
        border-radius: 50%;
        cursor: pointer;
        box-shadow: 0 2px 6px rgba(0,0,0,0.3);
        transition: all 0.3s ease;
    }
    
    .allocation-slider::-webkit-slider-thumb:hover {
        background: #333;
        transform: scale(1.1);
        box-shadow: 0 4px 10px rgba(0,0,0,0.4);
    }
    
    .allocation-slider::-moz-range-thumb {
        width: 24px;
        height: 24px;
        background: #555;
        border-radius: 50%;
        cursor: pointer;
        border: none;
        box-shadow: 0 2px 6px rgba(0,0,0,0.3);
        transition: all 0.3s ease;
    }
    
    .allocation-slider::-moz-range-thumb:hover {
        background: #333;
        transform: scale(1.1);
        box-shadow: 0 4px 10px rgba(0,0,0,0.4);
    }
    
    .allocation-slider::-moz-range-track {
        height: 8px;
        background: #e0e0e0;
        border-radius: 5px;
    }
    
    .earnings-display {
        margin-top: 30px;
        display: flex;
        justify-content: space-around;
        gap: 20px;
    }
    
    .scenario {
        padding: 15px;
        background: white;
        border: 2px solid #e0e0e0;
        border-radius: 8px;
        flex: 1;
        max-width: 200px;
        box-shadow: 0 2px 8px rgba(0,0,0,0.1);
    }
    
    .scenario strong {
        color: #555;
        display: block;
        margin-bottom: 5px;
    }
    
    #allocation-display {
        color: #555;
        font-weight: bold;
        font-size: 1.2em;
    }
    
    #fail-earnings {
        color: #dc3545;
        font-weight: bold;
        font-size: 1.1em;
    }
    
    #success-earnings {
        color: #28a745;
        font-weight: bold;
        font-size: 1.1em;
    }

    @media (max-width: 768px) {
        .container {
            margin: 10px;
            border-radius: 6px;
        }
        .survey-section {
            padding: 20px;
        }
        .form-group {
            padding: 15px;
        }
        
        .earnings-display {
            flex-direction: column;
            gap: 15px;
        }
        
        .slider-wrapper {
            gap: 10px;
        }
        
        .allocation-slider {
            max-width: 250px;
        }
    }
</style>

<div class="container">
    <div class="header">
        In this part of the study, you will not interact with other participants. Your earnings from this part will only depend on your own decisions.
        Part 2 of this study consists of 5 sections. We provide instructions for each section below.
    </div>

    <div class="section-progress">
        <div class="progress-indicator">Section 5 of 5</div>
    </div>

    <div class="survey-section">
        <form method="post">
            <div id="section-2" class="section-container active">
                <div class="question-section">
                    <h3>Section 5</h3>
                    <p>
                        This is the final section of Part 2. In this section, you will be asked to choose a portion of the 20 ECUs that you earned from completing
                        Section 1 to 4 and invest in a risky option. The amount that you can invest in the risky option is any whole number between 0 and 20. The rest of the earnings
                        (those you do not invest) will be kept in your balance.
                    <ul>
                        <li>There is a 50% probability that the investment will fail and a 50% probability that the investment will succeed. If 
                            the investment fails, you will lose the amount you invested. If the investment succeeds, you will received 2.5 times the amount invested.
                        </li>
                        <li>How do you know whether the risky investment succeeds? You will be asked ot choose Heads or Tails. At the end of the study, we will flip a coin.
                            Your investment succeeds if the outcome of the coin flip matches your choice.
                        </li>
                        <li>You will learn the outcome of this section at the end of the study. Please remember that your investment in this section is taken from
                            your earnings from completing the previous four sections. If you decide to invest a positive amount in the risky option, your total earnings
                            from Part 2 will be lower than 20 ECUs if the investment fails, and larger than 20 ECUs if the investment succeeds.
                        </li>
                        <li>You may use the slide bar below to enter the investment amount. The program will calculate your potential earnings in the two scenarios:
                            when the investment fails and when the investment succeeds. You can edit the amount of your investment until you click the "confirm" button.
                        </li>
                    </ul>
                    </p>
                </div>

                <div class="form-group">
                    <div class="slider-container">
                        <label class="form-label">Investment Amount: <span id="allocation-display">0</span> ECUs</label>
                        
                        <div class="slider-wrapper">
                            <span class="slider-label">0</span>
                            <input type="range" 
                                   id="allocation-slider" 
                                   name="allocate" 
                                   min="0" 
                                   max="20" 
                                   value="0" 
                                   step="1" 
                                   class="allocation-slider">
                            <span class="slider-label">20</span>
                        </div>
                        
                        <div class="earnings-display">
                            <div class="scenario">
                                <strong>If investment fails:</strong> 
                                <span id="fail-earnings">20</span> ECUs
                            </div>
                            <div class="scenario">
                                <strong>If investment succeeds:</strong> 
                                <span id="success-earnings">20</span> ECUs
                            </div>
                        </div>
                    </div>
                </div>

                <div class="form-group">
                    {{ formfield 'coin' }}
                </div>

                <button name="submit" value="True" class="submit-button">Confirm</button>
            </div>
        </form>
    </div>
</div>

<script>
    document.addEventListener('DOMContentLoaded', function() {
        const slider = document.getElementById('allocation-slider');
        const allocationDisplay = document.getElementById('allocation-display');
        const failEarnings = document.getElementById('fail-earnings');
        const successEarnings = document.getElementById('success-earnings');
        
        const baseEarnings = 20; // Total earnings from previous sections
        const multiplier = 2.5; // Success multiplier
        
        function updateEarningsDisplay(investmentAmount) {
            // Update the allocation display
            allocationDisplay.textContent = investmentAmount;
            
            // Calculate earnings for failure scenario
            // If investment fails, they lose the invested amount
            const failureEarnings = baseEarnings - investmentAmount;
            
            // Calculate earnings for success scenario  
            // If investment succeeds, they get 2.5x the invested amount back
            const successAmount = investmentAmount * multiplier;
            const successEarningsTotal = (baseEarnings - investmentAmount) + successAmount;
            
            // Update the display
            failEarnings.textContent = failureEarnings;
            successEarnings.textContent = successEarningsTotal;
        }
        
        // Initialize with default value
        updateEarningsDisplay(parseInt(slider.value));
        
        // Add event listener for slider changes
        slider.addEventListener('input', function() {
            updateEarningsDisplay(parseInt(this.value));
        });
        
        // Also listen for change events (for better browser compatibility)
        slider.addEventListener('change', function() {
            updateEarningsDisplay(parseInt(this.value));
        });
    });
</script>

{{ endblock }}
